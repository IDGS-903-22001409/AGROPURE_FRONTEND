<!-- src/app/shared/components/review-form/review-form.html -->
<mat-card class="review-form-card" *ngIf="showForm">
  <mat-card-header>
    <mat-card-title>
      <mat-icon>rate_review</mat-icon>
      Escribir Reseña
    </mat-card-title>
    <mat-card-subtitle>
      Comparte tu experiencia con este producto
    </mat-card-subtitle>
  </mat-card-header>

  <mat-card-content>
    <form [formGroup]="reviewForm" (ngSubmit)="onSubmit()">
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Calificación</mat-label>
        <mat-select formControlName="rating" required>
          <mat-option [value]="5">
            <div class="rating-option">
              <span class="stars">⭐⭐⭐⭐⭐</span>
              <span>Excelente (5 estrellas)</span>
            </div>
          </mat-option>
          <mat-option [value]="4">
            <div class="rating-option">
              <span class="stars">⭐⭐⭐⭐</span>
              <span>Muy bueno (4 estrellas)</span>
            </div>
          </mat-option>
          <mat-option [value]="3">
            <div class="rating-option">
              <span class="stars">⭐⭐⭐</span>
              <span>Bueno (3 estrellas)</span>
            </div>
          </mat-option>
          <mat-option [value]="2">
            <div class="rating-option">
              <span class="stars">⭐⭐</span>
              <span>Regular (2 estrellas)</span>
            </div>
          </mat-option>
          <mat-option [value]="1">
            <div class="rating-option">
              <span class="stars">⭐</span>
              <span>Malo (1 estrella)</span>
            </div>
          </mat-option>
        </mat-select>
        <mat-error *ngIf="reviewForm.get('rating')?.hasError('required')">
          Selecciona una calificación
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Tu reseña</mat-label>
        <textarea
          matInput
          formControlName="comment"
          rows="4"
          placeholder="Describe tu experiencia con este producto..."
          maxlength="1000"
        ></textarea>
        <mat-hint align="end">
          {{ reviewForm.get("comment")?.value?.length || 0 }}/1000
        </mat-hint>
        <mat-error *ngIf="reviewForm.get('comment')?.hasError('required')">
          Escribe tu comentario
        </mat-error>
        <mat-error *ngIf="reviewForm.get('comment')?.hasError('minlength')">
          Mínimo 10 caracteres
        </mat-error>
      </mat-form-field>

      <div class="form-actions">
        <button mat-button type="button" (click)="cancelReview()">
          Cancelar
        </button>
        <button
          mat-raised-button
          color="primary"
          type="submit"
          [disabled]="reviewForm.invalid || isSubmitting"
        >
          <mat-icon>send</mat-icon>
          {{ isSubmitting ? "Enviando..." : "Enviar Reseña" }}
        </button>
      </div>
    </form>
  </mat-card-content>
</mat-card>
