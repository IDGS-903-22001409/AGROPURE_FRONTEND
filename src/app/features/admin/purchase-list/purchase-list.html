<!-- src/app/features/admin/purchase-list/purchase-list.html -->
<div class="purchase-list-container">
  <div class="list-header">
    <div class="header-text">
      <h1>Gestión de Compras</h1>
      <p>Administra las compras a proveedores</p>
    </div>
    <button mat-raised-button color="primary" (click)="openPurchaseForm()">
      <mat-icon>add</mat-icon>
      Nueva Compra
    </button>
  </div>

  <mat-card *ngIf="purchases.length > 0; else noPurchases">
    <mat-card-content>
      <table mat-table [dataSource]="purchases" class="purchases-table">
        <ng-container matColumnDef="purchaseNumber">
          <th mat-header-cell *matHeaderCellDef>Número</th>
          <td mat-cell *matCellDef="let purchase">
            {{ purchase.purchaseNumber }}
          </td>
        </ng-container>

        <ng-container matColumnDef="supplier">
          <th mat-header-cell *matHeaderCellDef>Proveedor</th>
          <td mat-cell *matCellDef="let purchase">
            {{ purchase.supplierName }}
          </td>
        </ng-container>

        <ng-container matColumnDef="material">
          <th mat-header-cell *matHeaderCellDef>Material</th>
          <td mat-cell *matCellDef="let purchase">
            {{ purchase.materialName }}
          </td>
        </ng-container>

        <ng-container matColumnDef="quantity">
          <th mat-header-cell *matHeaderCellDef>Cantidad</th>
          <td mat-cell *matCellDef="let purchase">{{ purchase.quantity }}</td>
        </ng-container>

        <ng-container matColumnDef="unitCost">
          <th mat-header-cell *matHeaderCellDef>Costo Unitario</th>
          <td mat-cell *matCellDef="let purchase">
            ${{ purchase.unitCost | number : "1.2-2" }}
          </td>
        </ng-container>

        <ng-container matColumnDef="totalCost">
          <th mat-header-cell *matHeaderCellDef>Total</th>
          <td mat-cell *matCellDef="let purchase">
            <strong>${{ purchase.totalCost | number : "1.2-2" }}</strong>
          </td>
        </ng-container>

        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef>Estado</th>
          <td mat-cell *matCellDef="let purchase">
            <mat-chip [color]="getStatusColor(purchase.status)" selected>
              {{ purchase.status }}
            </mat-chip>
          </td>
        </ng-container>

        <ng-container matColumnDef="date">
          <th mat-header-cell *matHeaderCellDef>Fecha</th>
          <td mat-cell *matCellDef="let purchase">
            {{ purchase.purchaseDate | date : "dd/MM/yyyy" }}
          </td>
        </ng-container>

        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef>Acciones</th>
          <td mat-cell *matCellDef="let purchase">
            <button
              mat-icon-button
              color="primary"
              (click)="editPurchase(purchase)"
            >
              <mat-icon>edit</mat-icon>
            </button>
            <button
              mat-icon-button
              color="warn"
              (click)="deletePurchase(purchase)"
            >
              <mat-icon>delete</mat-icon>
            </button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>
    </mat-card-content>
  </mat-card>

  <ng-template #noPurchases>
    <mat-card>
      <mat-card-content>
        <div class="no-purchases">
          <mat-icon>shopping_cart</mat-icon>
          <h2>No hay compras registradas</h2>
          <p>Comienza registrando tu primera compra a proveedores.</p>
          <button
            mat-raised-button
            color="primary"
            (click)="openPurchaseForm()"
          >
            <mat-icon>add</mat-icon>
            Registrar Primera Compra
          </button>
        </div>
      </mat-card-content>
    </mat-card>
  </ng-template>
</div>
