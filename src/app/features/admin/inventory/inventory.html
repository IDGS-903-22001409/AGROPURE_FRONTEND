<div class="inventory-container">
  <div class="inventory-header">
    <h1>Inventario de Materiales</h1>
    <p>Estado actual del inventario basado en compras</p>
  </div>

  <mat-card *ngIf="inventory.length > 0; else noInventory">
    <mat-card-content>
      <table mat-table [dataSource]="inventory" class="inventory-table">
        <ng-container matColumnDef="materialName">
          <th mat-header-cell *matHeaderCellDef>Material</th>
          <td mat-cell *matCellDef="let item">{{ item.materialName }}</td>
        </ng-container>

        <ng-container matColumnDef="totalQuantity">
          <th mat-header-cell *matHeaderCellDef>Cantidad Total</th>
          <td mat-cell *matCellDef="let item">
            {{ item.totalQuantity | number : "1.2-2" }} {{ item.unit }}
          </td>
        </ng-container>

        <ng-container matColumnDef="averageCost">
          <th mat-header-cell *matHeaderCellDef>Costo Promedio</th>
          <td mat-cell *matCellDef="let item">
            ${{ item.averageCost | number : "1.2-2" }} / {{ item.unit }}
          </td>
        </ng-container>

        <ng-container matColumnDef="totalValue">
          <th mat-header-cell *matHeaderCellDef>Valor Total</th>
          <td mat-cell *matCellDef="let item">
            <strong>${{ item.totalValue | number : "1.2-2" }}</strong>
          </td>
        </ng-container>

        <ng-container matColumnDef="lastPurchaseDate">
          <th mat-header-cell *matHeaderCellDef>Ãšltima Compra</th>
          <td mat-cell *matCellDef="let item">
            {{ item.lastPurchaseDate | date : "dd/MM/yyyy" }}
          </td>
        </ng-container>

        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef>Estado</th>
          <td mat-cell *matCellDef="let item">
            <span [class]="getStockStatus(item.totalQuantity)">
              {{ getStockStatusText(item.totalQuantity) }}
            </span>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>

      <div class="inventory-summary">
        <div class="summary-card">
          <h3>Valor Total del Inventario</h3>
          <p class="total-value">
            ${{ getTotalInventoryValue() | number : "1.2-2" }}
          </p>
        </div>
      </div>
    </mat-card-content>
  </mat-card>

  <ng-template #noInventory>
    <mat-card>
      <mat-card-content>
        <div class="no-inventory">
          <mat-icon>inventory_2</mat-icon>
          <h2>No hay materiales en inventario</h2>
          <p>Registra compras para ver el inventario de materiales.</p>
        </div>
      </mat-card-content>
    </mat-card>
  </ng-template>
</div>
